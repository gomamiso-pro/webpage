<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>スマホ対応 Web設計・見積支援ツール</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <style>
    body {
      font-family: "Hiragino Sans", "Segoe UI", sans-serif;
      margin: 0;
      padding: 10px;
      background: #f7f7f7;
    }
    h1 { text-align: center; color: #333; font-size: 1.4rem; }
    section { background: #fff; padding: 15px; border-radius: 12px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; font-weight: bold; font-size: 0.9rem; }
    select, input, textarea {
      width: 100%; padding: 8px; margin-top: 4px; border-radius: 6px; border: 1px solid #ccc;
      font-size: 0.9rem;
    }
    button {
      width: 100%; background: #0078d4; color: white; border: none;
      padding: 12px; border-radius: 8px; margin-top: 15px;
      font-size: 1rem;
    }
    button:hover { background: #005fa3; }
    .result { background: #fff; padding: 15px; border-radius: 10px; margin-top: 20px; }
    table { width: 100%; border-collapse: collapse; font-size: 0.9rem; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #efefef; }
    .price { text-align: right; }
  </style>
</head>
<body>
  <h1>📱 Web設計・見積サポートツール</h1>

  <section>
    <h2>ヒアリングシート</h2>

    <label>システム種別</label>
    <select id="systemType">
      <option value="ECサイト">ECサイト</option>
      <option value="予約システム">予約システム</option>
      <option value="社内管理">社内管理</option>
      <option value="ポータルサイト">ポータルサイト</option>
    </select>

    <label>ターゲット層</label>
    <select id="target">
      <option>一般ユーザー</option>
      <option>法人</option>
      <option>学生・教育系</option>
      <option>高齢者向け</option>
    </select>

    <label>使用言語</label>
    <select id="lang">
      <option>HTML / CSS / JavaScript</option>
      <option>React / Node.js</option>
      <option>PHP / Laravel</option>
      <option>Python / Django</option>
    </select>

    <label>レイアウトイメージ</label>
    <select id="layout">
      <option>1カラム（スマホ中心）</option>
      <option>2カラム（PC・タブレット両対応）</option>
      <option>カード型デザイン</option>
    </select>

    <label>フォント</label>
    <select id="font">
      <option>サンセリフ（すっきり）</option>
      <option>明朝体（上品）</option>
      <option>丸ゴシック（親しみやすい）</option>
    </select>

    <label>色味</label>
    <select id="color">
      <option>ブルー系（信頼・誠実）</option>
      <option>グリーン系（安心・健康）</option>
      <option>オレンジ系（明るい・元気）</option>
      <option>モノトーン（落ち着き）</option>
    </select>

    <label>雰囲気</label>
    <select id="tone">
      <option>シンプル</option>
      <option>ポップ</option>
      <option>クール</option>
      <option>ナチュラル</option>
    </select>

    <label>ページ構成</label>
    <select id="pages" multiple size="4">
      <option>トップページ</option>
      <option>商品一覧 / 投稿一覧</option>
      <option>詳細ページ</option>
      <option>お問い合わせ / 管理画面</option>
    </select>

    <label>想定機能</label>
    <div id="featureList">
      <label><input type="checkbox" value="ログイン">ログイン</label>
      <label><input type="checkbox" value="検索">検索</label>
      <label><input type="checkbox" value="登録・編集">登録・編集</label>
      <label><input type="checkbox" value="コメント">コメント</label>
      <label><input type="checkbox" value="通知">通知</label>
      <label><input type="checkbox" value="分析">分析</label>
    </div>

    <label>テーブル数</label>
    <input type="number" id="tableCount" min="1" max="30" value="5">

    <button onclick="generateAll()">設計・見積を作成</button>
  </section>

  <section class="result" id="output"></section>

  <script>
    mermaid.initialize({ startOnLoad: false });

    function generateAll() {
      const systemType = document.getElementById("systemType").value;
      const target = document.getElementById("target").value;
      const lang = document.getElementById("lang").value;
      const layout = document.getElementById("layout").value;
      const font = document.getElementById("font").value;
      const color = document.getElementById("color").value;
      const tone = document.getElementById("tone").value;
      const pages = Array.from(document.getElementById("pages").selectedOptions).map(o => o.value);
      const features = Array.from(document.querySelectorAll("#featureList input:checked")).map(f => f.value);
      const tableCount = parseInt(document.getElementById("tableCount").value);

      const base = 150000;
      const perFeature = 30000;
      const perTable = 10000;
      const subtotal = base + features.length * perFeature + tableCount * perTable;
      const total = subtotal * 1.1;

      // 概要
      let html = `<h3>📘 システム概要</h3>
        <p>${systemType}（ターゲット：${target}）<br>
        使用言語：${lang}<br>
        レイアウト：${layout} / フォント：${font}<br>
        カラー：${color} / 雰囲気：${tone}</p>`;

      // 機能一覧
      html += `<h3>🧩 機能一覧</h3><table><tr><th>No</th><th>機能名</th><th>概要</th></tr>`;
      features.forEach((f, i) => html += `<tr><td>${i+1}</td><td>${f}</td><td>${f}に関する機能</td></tr>`);
      html += `</table>`;

      // テーブル設計
      html += `<h3>🗂️ テーブル設計（仮）</h3><table><tr><th>No</th><th>テーブル名</th><th>主な項目</th></tr>`;
      for (let i=0;i<tableCount;i++){
        const name = features[i % features.length] || `汎用データ`;
        html += `<tr><td>${i+1}</td><td>${name}_tbl</td><td>id, ${name}_name, updated_at</td></tr>`;
      }
      html += `</table>`;

      // 見積明細
      html += `<h3>💰 見積明細</h3>
        <table>
        <tr><th>項目</th><th>単価</th><th>数量</th><th>小計</th></tr>
        <tr><td>基本設計費</td><td class="price">150,000</td><td>1</td><td class="price">150,000</td></tr>
        <tr><td>機能実装</td><td class="price">30,000</td><td>${features.length}</td><td class="price">${features.length * 30000}</td></tr>
        <tr><td>DB設計</td><td class="price">10,000</td><td>${tableCount}</td><td class="price">${tableCount * 10000}</td></tr>
        <tr><th colspan="3">合計（税抜）</th><th class="price">${subtotal.toLocaleString()}</th></tr>
        <tr><th colspan="3">税込</th><th class="price">${Math.round(total).toLocaleString()} 円</th></tr>
        </table>`;

      // 画面遷移図
      let mermaidCode = "graph TD;\n";
      pages.forEach((p,i) => {
        if (i < pages.length - 1) mermaidCode += `${p}-->${pages[i+1]}\n`;
      });
      html += `<h3>🧭 画面遷移図</h3><div class="mermaid">${mermaidCode}</div>`;

      document.getElementById("output").innerHTML = html;
      mermaid.init(undefined, document.querySelectorAll('.mermaid'));
    }
  </script>
</body>
</html>
